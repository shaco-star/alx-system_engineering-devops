#!/usr/bin/env bash
# Configures an Nginx server to redirect /redirect_me to another page

# Install Nginx
sudo apt-get install -y nginx

# Start Nginx
sudo service nginx start

# Create an index.html file with the string "Hello World!"
echo "Hello World!" | sudo tee /var/www/html/index.html

# Create a server block configuration file for the redirection
sudo bash -c 'cat > /etc/nginx/sites-available/redirection <<EOF
server {
    listen 80;
    server_name localhost;

    location /redirect_me {
        return 301 http://example.com/;
    }
}
EOF'

# Enable the server block by creating a symbolic link to the sites-enabled directory
sudo ln -s /etc/nginx/sites-available/redirection /etc/nginx/sites-enabled/

# Create a custom 404 page
sudo bash -c 'echo "Ceci n'\''est pas une page" > /usr/share/nginx/html/404.html'

# Update the Nginx configuration to use the custom 404 page
sudo sed -i 's|#error_page 404 /404.html;|error_page 404 /404.html;|' /etc/nginx/sites-available/default

# Test the Nginx configuration for syntax errors
sudo nginx -t

# Reload the Nginx service to apply the changes
sudo service nginx reload
